<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Dawghaus</title>

    <link rel="stylesheet" href="dawghaus.css" />

    <script src="lib/jquery-1.8.2.min.js"></script>
    <script src="lib/jquery.console.js"></script>
    <script src="lib/roy.js"></script>
    <script src="lib/htmlrepl.js"></script>
    <script src="lib/royloader.js"></script>
    <script src="turtle.js"></script>
    <script>
      $(function() {
        turtle = Turtle($("#turtlegraphics"), 900, 300)
      })
    </script>
    <script>
      royhelper = {
        arrays: {
          concat: function(xs, ys) { return xs.concat(ys) },
          length: function(xs) { return xs.length },
          tail: function(xs) { return xs.slice(1)Â }

        }
      }
    </script>
    <script type="text/roy" language="roy">
      // Turtle interface in Roy

      let fd d = \() -> turtle.fd d
      let lt a = \() -> turtle.lt a
      let rt a = \() -> turtle.rt a
      let pendown = \() -> turtle.pendown ()
      let penup = \() -> turtle.penup ()

      // Array utils

      let always x = (\() -> x)
      let length xs = royhelper.arrays.length xs
      let empty xs = (length xs) == 0
      let concat xs ys = royhelper.arrays.concat xs ys
      let cons x xs = concat [x] xs
      let head xs = xs@0
      let tail xs = royhelper.arrays.tail xs
      let times n x = map (always x) (series 1 n)
      let map f xs = 
        if empty xs then
          []
        else
          cons (f (head xs)) (map f (tail xs))
      let filter f xs = 
        if empty xs then
          []
        else
          if f (head xs) then
            cons (head xs) (filter f (tail xs))
          else
            filter f (tail xs)
      let series start end = 
        if start > end then
          []
        else
          cons start (series (start+1) end)

      // Action sequencing / repeat utils

      let sequence fs = \() ->
        let invoke f = f ()
        map invoke fs
      let repeat n f = sequence (times n f)
    </script>

  </head>
  <body>
     <div id="turtlegraphics">
     </div>
     <div class="console"></div>
  </body>
</html>
