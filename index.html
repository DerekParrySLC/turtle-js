<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Dawghaus</title>

    <link rel="stylesheet" href="dawghaus.css" />

    <script src="lib/jquery-1.8.2.min.js"></script>
    <script src="lib/jquery.console.js"></script>
    <script src="lib/roy.js"></script>
    <script src="lib/htmlrepl.js"></script>
    <script src="lib/royloader.js"></script>
    <script src="turtle.js"></script>
    <script>
      $(function() {
        turtle = Turtle($("#turtlegraphics"), 900, 300)
      })
    </script>
    <script>
      royhelper = {
        arrays: {
          concat: function(xs, ys) { return xs.concat(ys) },
          length: function(xs) { return xs.length },
          tail: function(xs) { return xs.slice(1)Â }

        }
      }
    </script>
    <script type="text/roy" language="roy">
      let show x = (Object x).toString()
      let fd d = \() -> turtle.fd d
      let lt a = \() -> turtle.lt a
      let rt a = \() -> turtle.rt a
      let pendown = \() -> turtle.pendown ()
      let penup = \() -> turtle.penup ()

      let always x = (\() -> x)

      let length xs = royhelper.arrays.length xs
      let empty xs = (length xs) == 0
      let concat xs ys = royhelper.arrays.concat xs ys
      let cons x xs = concat [x] xs
      let head xs = xs@0
      let tail xs = royhelper.arrays.tail xs

      // xs :: IO ()
      let sequence xs = \() ->
        if empty xs then
          []
        else
          let first = (head xs) ()
          let rest = (sequence (tail xs)) ()
          (cons first rest)

      let map f xs = 
        if empty xs then
          []
        else
          cons (f (head xs)) (map f (tail xs))

      let series start end = 
        if start > end then
          []
        else
          cons start (series (start+1) end)

      let ioMonad = {
        return: \x -> always x
        bind: \action f -> 
                           (\() -> 
                             let value = action ()
                             let action2 = f value
                             action2 ()
                           )
      }

      let runIO action = action ()

      let putStrLn line = \() -> 
        console.log line

      let main = do ioMonad
        text <- (\() -> "hello")
        _ <- putStrLn text
        _ <- putStrLn 1
        putStrLn 2
    </script>

  </head>
  <body>
     <div id="turtlegraphics">
     </div>
     <div class="console"></div>
  </body>
</html>
